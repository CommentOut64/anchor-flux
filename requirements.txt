--extra-index-url https://download.pytorch.org/whl/cu118

# --- 核心环境 ---
python-dateutil
tqdm
click
colorama
filelock
psutil
intel-openmp  # fbgemm.dll 需要的 OpenMP 运行时

# --- 数值计算 (严格锁定兼容性) ---
# 必须 < 2.0.0 以兼容现有生态
numpy==1.26.4
scipy
sympy

# --- PyTorch (CUDA 11.8) ---
# 包含 CUDA 11 运行库
# 注意: torchvision 已移除以减小安装包体积 (~800MB)
torch==2.4.0+cu118
torchaudio==2.4.0+cu118

# --- AI 推理引擎 (混合 CUDA 环境) ---
# Faster-Whisper 1.2.1 需要 CTranslate2 4.x
faster-whisper==1.2.1

# 锁定 CTranslate2 版本以配合下面的 CUDA 12 库
ctranslate2==4.4.0

# --- 关键：嵌入式 CUDA 12 运行库 ---
# 虽然 PyTorch 用的是 cu11，但 CTranslate2 需要这些 cu12 的 DLL。
# pip 安装会将它们放在 site-packages/nvidia 中，实现完美共存。
# 注意：ctranslate2 4.4.0 需要 cuDNN 8，不能用 cuDNN 9
nvidia-cublas-cu12==12.1.3.1
nvidia-cudnn-cu12==8.9.7.29

# --- ONNX (兼容性配置) ---
# 强制排除 CPU 版本，只使用 GPU 版本
# onnxruntime-gpu 完全兼容 CPU 推理，可满足 funasr-onnx 的依赖
onnxruntime-gpu==1.18.0

# --- FunASR (语音识别) ---
# 注意：funasr-onnx 依赖 onnxruntime，但我们用 onnxruntime-gpu 替代
# 安装后必须执行：pip uninstall onnxruntime -y
funasr-onnx==0.4.1

# --- 音频处理 ---
librosa
soundfile
ffmpeg-python
av
pydub

# --- 人声分离 ---
demucs==4.0.1

# --- VAD & Web 服务 ---
silero-vad
fastapi
uvicorn[standard]
python-multipart
sse-starlette